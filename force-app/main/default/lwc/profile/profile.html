<template>
    <div id="profile" class="page">

        <div class="loader" if:true={isLoading}>
            <lightning-spinner
                alternative-text="Loading..."
                size="medium"
                variant="brand">
            </lightning-spinner>
        </div>

            <div class="profile-container" if:false={isLoading}>
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="profile-avatar">{user.abbreviation}</div>
                        <div class="profile-name">{user.fullname}</div>
                        <div class="profile-role">Software Developer</div>
                    </div>
                    <form class="profile-form">
                        <div class="form-group">
                            <label class="form-label">User Id</label>
                            <input type="text" class="form-control" value={user.Id} readonly data-field="Id"> 
                        </div>
                        <div class="form-group">
                            <label class="form-label">Username</label>
                            <input type="text" class="form-control" value={user.username} readonly={cannotEdit} onchange={updateField} data-field="username">
                        </div>
                        <div class="form-group">
                            <label class="form-label">First Name</label>
                            <input type="text" class="form-control" value={user.fname} readonly data-field="fname"> 
                        </div>
                        <div class="form-group">
                            <label class="form-label">Last Name</label>
                            <input type="text" class="form-control" value={user.lname} readonly data-field="lname">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email Address</label>
                            <input type="email" class="form-control" value={user.email} readonly data-field="email">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" value={user.phone} readonly={cannotEdit} onchange={updateField} data-field="phone" max="10">
                        </div>
                        <div class="form-group">
                            <label class="form-label">College Name</label>
                            <input type="text" class="form-control" value={user.collegeName} readonly={cannotEdit} onchange={updateField} data-field="collegeName">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Street Address</label>
                            <input type="text" class="form-control" value={user.street} readonly={cannotEdit} onchange={updateField} data-field="street">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pin Code</label>
                            <input type="text" class="form-control" value={user.pinCode} readonly={cannotEdit} onchange={updateField} data-field="pinCode" max="6">
                        </div>
                        <div class="form-group">
                            <label class="form-label">City</label>
                            <select 
                                class="form-select" 
                                onchange={handleCityChange} 
                                disabled={cannotEdit}>
                                <template for:each={cityWithSelection} for:item="city">
                                    <option 
                                        key={city.value} 
                                        value={city.value} 
                                        selected={city.selected}>
                                        {city.label}
                                    </option>
                                </template>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">State</label>
                            <select 
                                class="form-select" 
                                onchange={handleStateChange} 
                                disabled={cannotEdit}>
                                <template for:each={statesWithSelection} for:item="state">
                                    <option 
                                        key={state.value} 
                                        value={state.value} 
                                        selected={state.selected}>
                                        {state.label}
                                    </option>
                                </template>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Country</label>
                             <select 
                                class="form-select" 
                                disabled
                                >
                                <template for:each={countries} for:item="country">
                                    <option 
                                        key={country.value} 
                                        value={country.value}
                                        selected
                                        >
                                        {country.label}
                                    </option>
                                </template>
                            </select>
                        </div>

                    </form>
                    <div class="btn-container">
                        <button class="btn btn-primary" onclick={updateProfile}>{editButtonText}</button>
                        <button if:false={cannotEdit} class="btn btn-primary" onclick={cancelEdit}>Cancel</button>
                    </div>
                </div>
            </div>
        </div>

</template>
